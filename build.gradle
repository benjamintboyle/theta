buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:2.0.3.RELEASE")
    }
}

apply plugin: 'application'
apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'org.springframework.boot'
apply plugin: 'io.spring.dependency-management'
apply plugin: 'findbugs'
apply plugin: 'checkstyle'

mainClassName = "theta.ThetaEngine"

group = 'theta'
// Removed (possibly temporarily) so distribution isn't always changing filename
// version = '0.2'

// Dependency versions
ext.slf4jVersion         = '1.+'
ext.log4jVersion         = '2.+'
ext.rxJavaVersion        = '2.+'
ext.springBootVersion    = '2.0.4.RELEASE';

// Test dependency versions
ext.hamcrestVersion      = '2.+'
ext.mockitoVersion       = '2.+'
ext.junitJupiterVersion  = '5.+'
ext.junitPlatformVersion  ='1.+'

repositories {
    mavenCentral()
}

sourceCompatibility = 10
targetCompatibility = 10

dependencies {
    // Production code dependencies
    implementation("org.slf4j:slf4j-api:${slf4jVersion}")
    implementation("org.apache.logging.log4j:log4j-api:${log4jVersion}")
    implementation("org.apache.logging.log4j:log4j-core:${log4jVersion}")
    implementation("org.apache.logging.log4j:log4j-slf4j-impl:${log4jVersion}")
    implementation("io.reactivex.rxjava2:rxjava:${rxJavaVersion}")
    implementation("org.springframework.boot:spring-boot-starter-web:${springBootVersion}");

    implementation files('libs/interactive-brokers-api-9.72.18.jar')

    // Test code dependencies
    testImplementation("org.hamcrest:java-hamcrest:${hamcrestVersion}")
    testImplementation("org.mockito:mockito-core:${mockitoVersion}")
    testImplementation("org.mockito:mockito-junit-jupiter:${mockitoVersion}")

    // Junit 5
    testImplementation("org.junit.jupiter:junit-jupiter-api:${junitJupiterVersion}")
    testRuntimeOnly("org.junit.jupiter:junit-jupiter-engine:${junitJupiterVersion}")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher:${junitPlatformVersion}")
}

test {
	useJUnitPlatform()
	
	maxParallelForks = Runtime.runtime.availableProcessors().intdiv(2) ?: 1

	testLogging {
		events "passed", "skipped", "failed"
	}

	reports {
		html.enabled = true
	}
}

distZip {
    enabled = false
}

wrapper {
    gradleVersion = '4.9'
}
